"use strict";const e=require("../../common/vendor.js"),t=require("../../utils/algorithm.js");Math||a();const a=()=>"../../Components/echarts/l-echart/l-echart.js",l={__name:"shortest",setup(a){const l=e.ref([]),s=e.ref(""),r=e.ref(null);let o=e.ref([]),i=e.ref(0);const n=["#5c7bd9","red","orange","yellow","green","blue","purple"],u=n.length,c=()=>{l.value.push([])};let h=new Map,v=new Map;const d=()=>{try{const e=new Set(s.value.trim().split(/\s+/));if(!e)throw new Error("节点不允许为空");if(!r.value)throw new Error("起点不允许为空");if(!e.has(r.value))throw new Error("起点不存在");i.value=0,y.series[0].data=[],y.series[0].links=[],S=[],b=[],h.clear(),o.value=t.dijkstra(l.value,e,r.value),y.series[0].data=((e,t,a=20)=>{const l=[];let s=0;e.forEach((e=>{h.set(e,s),l.push({name:e,colorIndex:0,color:n[0],value0:t,value1:t===e?0:"Infinity"}),s++}));let r=360/s*Math.PI/180;for(let o=0;o<s;o++)l[o].x=Math.sin(r*o)*a+p.value,l[o].y=-Math.cos(r*o)*a+g.value;return l})(e,r.value);let a=0;l.value.forEach((([t,l,s])=>{if(!t||!l||!s)throw new Error("不允许空值");if(!e.has(t)||!e.has(l))throw new Error("未定义的节点");y.series[0].links.push({source:t,target:l,label:{show:!0,formatter:s},tooltip:{show:!1},lineStyle:{color:n[0]}}),v.set(`${t}--${l}`,a++)})),S.push(JSON.parse(JSON.stringify(y.series[0].data))),b.push(JSON.parse(JSON.stringify(y.series[0].links))),m()}catch(a){console.log(a.message),e.index.showToast({title:a.message,icon:"error",duration:1e3})}},f=e.ref(null);let p=e.ref(0),g=e.ref(0);const w=require("../../static/echarts.min.js");let y={title:{text:"最短路径"},tooltip:{show:!0,formatter:e=>`(${e.data.value0}, ${e.data.value1})`},animation:!1,series:[{type:"graph",layout:"none",symbolSize:50,roam:!0,label:{show:!0},edgeLabel:{fontSize:20},itemStyle:{color:function(e){return e.data.color}},data:[],links:[],lineStyle:{opacity:.9,width:2,curveness:0}}]};const m=()=>{f.value&&f.value.init(w,(e=>{e.setOption(y,!0)}))};let S=[],b=[];const $=e=>{if(b.length>e&&S.length>e)y.series[0].data=S[e],y.series[0].links=b[e];else{const t=o.value[e-1],a=Object.keys(t)[0],l=t[a],s=h.get(a),r=y.series[0].data[s].colorIndex++,i=n[(r+1)%u];y.series[0].data[s].color=i;for(const[e,o]of l){const t=h.get(e);let l;y.series[0].data[t].value0=a,y.series[0].data[t].value1=o,v.has(`${a}--${e}`)?l=v.get(`${a}--${e}`):v.has(`${e}--${a}`)&&(l=v.get(`${e}--${a}`)),y.series[0].links[l].lineStyle.color=i}S.push(JSON.parse(JSON.stringify(y.series[0].data))),b.push(JSON.parse(JSON.stringify(y.series[0].links)))}m()},k=()=>{i.value--,i.value<0?i.value=0:$(i.value)},O=()=>{i.value++;const e=o.value.length+1;i.value>=e?i.value=e-1:$(i.value)};return e.onMounted((()=>{e.index.createSelectorQuery().select(".chartRef").boundingClientRect((({width:e,height:t})=>{p.value=e/2,g.value=t/2})).exec()})),e.onBeforeUnmount((()=>{f.value.dispose(),f.value=null})),(t,a)=>({a:s.value,b:e.o((e=>s.value=e.detail.value)),c:e.o(c),d:e.f(l.value,((t,a,s)=>({a:t[0],b:e.o((e=>t[0]=e.detail.value),a),c:t[1],d:e.o((e=>t[1]=e.detail.value),a),e:t[2],f:e.o((e=>t[2]=e.detail.value),a),g:e.o((e=>(e=>{l.value.splice(e,1)})(a)),a),h:a}))),e:r.value,f:e.o((e=>r.value=e.detail.value)),g:e.o(d),h:e.sr(f,"eab5e3dc-0",{k:"chartRef"}),i:e.o(k),j:e.o(O),k:e.unref(o).length})}},s=e._export_sfc(l,[["__scopeId","data-v-eab5e3dc"]]);wx.createPage(s);
